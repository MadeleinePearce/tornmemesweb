{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
        <title>TornMemes</title>
        <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700" />
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css" />
    </head>

    <body style="background-color: #C5C5C5;">
        <nav class="navbar navbar-dark navbar-expand-lg fixed-top bg-white portfolio-navbar" style="background: linear-gradient(0deg,#0C1014 0%,#344657 100%); box-shadow: 0 1px 0 #ffffff0d;">
            <div class="container">
                <a class="navbar-brand logo" href="#">TornMemes</a>
                <button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navbarNav"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <main class="page lanidng-page">
            <section class="portfolio-block block-intro">
                <div class="container">
                    <div class="about-me">
                        <p>
                            Welcome to&nbsp;<strong>TornMemes</strong>!<br />
                            upload TORN related memes and earn fame &amp; rewards.
                        </p>
                        <a class="btn btn-secondary" role="button" href="#"><i class="fas fa-upload p-2"></i><span>Upload Memes</span><i class="fas fa-upload p-2"></i></a>
                    </div>
                </div>
            </section>
            {% if memes_group1 %}
            <div class="card-group">
                {% for meme in memes_group1 %}
                <div class="card p-2" style="background-color: #f5f5f5;">
                    <img class="card-img-top w-100 d-block" src="{{ meme.image_link }}" data-bs-toggle="modal" data-bs-target="#memeModal" onclick="setMemeModal(this.src);"/>
                    <div class="card-body text-center">
                        <p class="card-text"><strong>{{ meme.tornplayer.username }} [{{ meme.tornplayer.torn_id }}]</strong><br>{{ meme.caption }}</p>
                        <div class="btn-group" role="group">
                            <button class="btn btn-primary btn-success" type="button"><i class="fas fa-thumbs-up"></i>&nbsp; {{ meme.likes }}</button>
                            <button class="btn btn-primary btn-warning" type="button"><a target="_blank" style="color: black;" href="https://www.torn.com/sendcash.php#/XID={{ meme.tornplayer.torn_id }}"> <i class="fas fa-dollar-sign"></i></a></button>
                            <button class="btn btn-primary btn-danger" type="button"><i class="fas fa-thumbs-down"></i>&nbsp; {{ meme.dislikes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if memes_group2 %}
            <div class="card-group">
                {% for meme in memes_group2 %}
                <div class="card p-2" style="background-color: #f5f5f5;">
                    <img class="card-img-top w-100 d-block" src="{{ meme.image_link }}" data-bs-toggle="modal" data-bs-target="#memeModal" onclick="setMemeModal(this.src);"/>
                    <div class="card-body text-center">
                        <p class="card-text"><strong>{{ meme.tornplayer.username }} [{{ meme.tornplayer.torn_id }}]</strong><br>{{ meme.caption }}</p>
                        <div class="btn-group" role="group">
                            <button class="btn btn-primary btn-success" type="button"><i class="fas fa-thumbs-up"></i>&nbsp; {{ meme.likes }}</button>
                            <button class="btn btn-primary btn-warning" type="button"><a target="_blank" style="color: black;" href="https://www.torn.com/sendcash.php#/XID={{ meme.tornplayer.torn_id }}"> <i class="fas fa-dollar-sign"></i></a></button>
                            <button class="btn btn-primary btn-danger" type="button"><i class="fas fa-thumbs-down"></i>&nbsp; {{ meme.dislikes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if memes_group3 %}
            <div class="card-group">
                {% for meme in memes_group3 %}
                <div class="card p-2" style="background-color: #f5f5f5;">
                    <img class="card-img-top w-100 d-block" src="{{ meme.image_link }}" data-bs-toggle="modal" data-bs-target="#memeModal" onclick="setMemeModal(this.src);"/>
                    <div class="card-body text-center">
                        <p class="card-text"><strong>{{ meme.tornplayer.username }} [{{ meme.tornplayer.torn_id }}]</strong><br>{{ meme.caption }}</p>
                        <div class="btn-group" role="group">
                            <button class="btn btn-primary btn-success" type="button"><i class="fas fa-thumbs-up"></i>&nbsp; {{ meme.likes }}</button>
                            <button class="btn btn-primary btn-warning" type="button"><a target="_blank" style="color: black;" href="https://www.torn.com/sendcash.php#/XID={{ meme.tornplayer.torn_id }}"> <i class="fas fa-dollar-sign"></i></a></button>
                            <button class="btn btn-primary btn-danger" type="button"><i class="fas fa-thumbs-down"></i>&nbsp; {{ meme.dislikes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if memes_group4 %}
            <div class="card-group">
                {% for meme in memes_group4 %}
                <div class="card p-2" style="background-color: #f5f5f5;">
                    <img class="card-img-top w-100 d-block" src="{{ meme.image_link }}" data-bs-toggle="modal" data-bs-target="#memeModal" onclick="setMemeModal(this.src);"/>
                    <div class="card-body text-center">
                        <p class="card-text"><strong>{{ meme.tornplayer.username }} [{{ meme.tornplayer.torn_id }}]</strong><br>{{ meme.caption }}</p>
                        <div class="btn-group" role="group">
                            <button class="btn btn-primary btn-success" type="button"><i class="fas fa-thumbs-up"></i>&nbsp; {{ meme.likes }}</button>
                            <button class="btn btn-primary btn-warning" type="button"><a target="_blank" style="color: black;" href="https://www.torn.com/sendcash.php#/XID={{ meme.tornplayer.torn_id }}"> <i class="fas fa-dollar-sign"></i></a></button>
                            <button class="btn btn-primary btn-danger" type="button"><i class="fas fa-thumbs-down"></i>&nbsp; {{ meme.dislikes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if memes_group5 %}
            <div class="card-group">
                {% for meme in memes_group5 %}
                <div class="card p-2" style="background-color: #f5f5f5;">
                    <img class="card-img-top w-100 d-block" src="{{ meme.image_link }}" data-bs-toggle="modal" data-bs-target="#memeModal" onclick="setMemeModal(this.src);"/>
                    <div class="card-body text-center">
                        <p class="card-text"><strong>{{ meme.tornplayer.username }} [{{ meme.tornplayer.torn_id }}]</strong><br>{{ meme.caption }}</p>
                        <div class="btn-group" role="group">
                            <button class="btn btn-primary btn-success" type="button"><i class="fas fa-thumbs-up"></i>&nbsp; {{ meme.likes }}</button>
                            <button class="btn btn-primary btn-warning" type="button"><a target="_blank" style="color: black;" href="https://www.torn.com/sendcash.php#/XID={{ meme.tornplayer.torn_id }}"> <i class="fas fa-dollar-sign"></i></a></button>
                            <button class="btn btn-primary btn-danger" type="button"><i class="fas fa-thumbs-down"></i>&nbsp; {{ meme.dislikes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% if memes_on_page == 0 %}
            <div class="row">
                <div class="col text-center">
                    <h3>Sorry! We ran out of memes.</h3>
                </div>
            </div>
            {% endif %}
            <section class="portfolio-block call-to-action border-bottom">
                <nav id="pagination-ui">
                    <ul class="pagination justify-content-center">
                        <li class="page-item disabled" id="prev-button"><a id="prev-button-link" class="page-link">Prev</a></li>
                        <li class="page-item active"><a class="page-link" id="current-page">0</a></li>
                        <li class="page-item disabled" id="next-button"><a id="next-button-link" class="page-link">Next</a></li>
                    </ul>
                  </nav>
            </section>
        </main>
        <section class="portfolio-block website" style="background: linear-gradient(0deg,#0C1014 0%,#344657 100%); box-shadow: 0 1px 0 #ffffff0d;">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col text-center">
                        <img class="img-fluid" src="https://www.torn.com/signature.php?id=1&amp;user=2680763" />
                        <a href="#" style="text-decoration: none; color: white;" data-bs-toggle="modal" data-bs-target="#advertiseModal"><h6 class="p-2">Advertise Here</h6></a>
                        <img class="img-fluid" src="https://www.torn.com/signature.php?id=1&amp;user=2680763" />
                    </div>
                </div>
            </div>
        </section>
        <footer class="page-footer">
            <h6>
                Made with&nbsp;❤️ by<a target="_blank" style="text-decoration: none" href="https://www.torn.com/profiles.php?XID=2680763">XeN0N_2021</a>&amp;<a target="_blank" style="text-decoration: none" href="https://www.torn.com/profiles.php?XID=2695912">Apk-ash</a>
            </h6>
        </footer>
        <div class="modal fade" role="dialog" tabindex="-1" id="advertiseModal">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header"><h5>Advertise in TornMemes</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
                    <div class="modal-body text-center">
                        <p style="padding-top: 1rem;">Advertise Here<br /></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" role="dialog" tabindex="-1" id="memeModal">
            <div class="modal-dialog modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-header"><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
                    <div class="modal-body text-center">
                        <img id="meme-image-link" class="img-fluid" src="#">
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" role="dialog" tabindex="-1" id="loginModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header"><h5>Login</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="col-form-label">Torn API Key:</label>
                            <input type="text" class="form-control" id="torn-api-key">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary">Submit</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- <script src="{% static 'js/script.min.js' %}"></script> -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            function setMemeModal(url){
                $("#meme-image-link").attr("src", url);
            }
            var total_pages = parseInt("{{ total_pages|escapejs }}");
            var memes_on_page = parseInt("{{ memes_on_page|escapejs }}");
            const urlParams = new URLSearchParams(window.location.search);
            if(total_pages === 0){
                $('#pagination-ui').hide();
            } else {
                var current_page = parseInt(urlParams.get('page') || "1");
                $("#current-page").html(current_page);
                if(memes_on_page === 0){
                    $("#prev-button").removeClass("disabled");
                    $("#prev-button-link").attr('href', "/?page=" + (current_page - 1));
                } else if(memes_on_page !== 0 && current_page === 1){
                    if(current_page + 1 <= total_pages){
                        $("#next-button").removeClass("disabled");
                        $("#next-button-link").attr('href', "/?page=" + (current_page + 1));
                    }
                } else if(memes_on_page !== 0 && current_page > 1){
                    $("#prev-button").removeClass("disabled");
                    $("#prev-button-link").attr('href', "/?page=" + (current_page - 1));
                    if(current_page + 1 <= total_pages){
                        $("#next-button").removeClass("disabled");
                        $("#next-button-link").attr('href', "/?page=" + (current_page + 1));
                    }
                }
            }
        </script>
    </body>
</html>